<!DOCTYPE html>
<html>
    <head lang="en">
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>CCT2019 - ~/xv1&#39;s projects</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="../../../css/fonts.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" media="screen" href="../../../css/main.css" />
    </head>
    <body>
        <div class="content">
            <header>
                <div class="main">
                    <a href="../../../index.html">~/xv1&#39;s projects</a>
                </div>
                <nav>
                    
                    <a href="../../../writeups/index.html">./writeups</a>
                    
                </nav>
            </header>
            <main>
                <article>
                    <div class="title">
                        <h1 class="title">CCT2019</h1>
                        <div class="meta">Posted on Jun 15, 2024</div>
                    </div>
                    <div class="post-tags">
                        <nav class="nav tags">
                            <ul class="tags">
                                <li><a href="/tagsthm">thm</a></li>
                            </ul>
                        </nav>
                    </div>
                    <section class="body">
                        <p><a href="http://tryhackme.com/r/room/cct2019">ctf link</a></p>
                        <blockquote>
                            <p>Legacy challenges from the US Navy Cyber Competition Team 2019 Assessment sponsored by US TENTH Fleet</p>
                        </blockquote>
                        <p>I think this is the longest a CTF has ever taken me</p>
                        <h4 id="steps">Steps</h4>
                        <p><strong>Challenge 1</strong></p>
                        <ul>
                            <li>The first <code>pcap</code> file only has 20 frames</li>
                            <li>They are all <code>URB_BULK</code> packets, which is a <code>USB</code> protocol</li>
                            <li>frame number 2 had the visible file name <code>pcap_chal.pcap</code> in the hex data</li>
                            <li>Seeing this I ran <code>binwalk</code> to extract any other files within the pcap</li>
                        </ul>
                        <pre tabindex="0"><code>└─$ binwalk pcap2_1583863710056.pcapng

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
471           0x1D7           Zip archive data, at least v2.0 to extract, compressed size: 2308021, uncompressed size: 2731652, name: pcap_chal.pcap
2309652       0x233E14        End of Zip archive, footer length: 22
</code></pre>
                        <ul>
                            <li>Extracting with <code>binwalk -e</code> directly didn&rsquo;t work and since the challenge specified maintaining file integrity was really important I decided to try a different method</li>
                            <li>Instead I extracted the hex data directly and ran <code>binwalk</code> on that</li>
                            <li>For this I used <code>tshark</code></li>
                        </ul>
                        <div class="highlight">
                            <pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># -r for infile, -T for text output format, -e specify field, usb.capdata is the leftover capture data</span>
</span></span><span style="display:flex;"><span>tshark -r pcap2_1583863710056.pcapng -T fields -e usb.capdata &gt; extractedpcap
</span></span></code></pre>
                        </div>
                        <ul>
                            <li><a href="http://www.wireshark.org/docs/dfref/u/usb.html">http://www.wireshark.org/docs/dfref/u/usb.html</a> -&gt; wireshark docs are helpful for field names</li>
                            <li><code>extractedpcap</code> is useless to binwalk since it&rsquo;s pure hex data, so I converted it</li>
                        </ul>
                        <div class="highlight">
                            <pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># hex to binary</span>
</span></span><span style="display:flex;"><span>└─$ cat extractedpcap | xxd -r -p &gt;&gt; unhexed
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>└─$ file unhexed
</span></span><span style="display:flex;"><span>unhexed: data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>└─$ binwalk unhexed
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>DECIMAL       HEXADECIMAL     DESCRIPTION
</span></span><span style="display:flex;"><span>--------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">28</span>            0x1C            Zip archive data, at least v2.0 to extract, compressed size: 2308021, uncompressed size: 2731652, name: pcap_chal.pcap
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2308189</span>       0x23385D        End of Zip archive, footer length: <span style="color:#ae81ff">22</span>
</span></span></code></pre>
                        </div>
                        <ul>
                            <li>Yayyyyyy :&gt;</li>
                            <li>Now we can extract with <code>binwalk -e</code> with no issues</li>
                            <li>CDed into the extracted directory</li>
                        </ul>
                        <div class="highlight">
                            <pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>└─$ ls
</span></span><span style="display:flex;"><span>1C.zip  pcap_chal.pcap
</span></span></code></pre>
                        </div>
                        <ul>
                            <li><code>pcap_chal.pcap</code> is a much larger pcap file filled a variety of requests <code>ICMP, TCP, TLS, DNS</code>, etc</li>
                            <li><code>TCP</code> and <code>DNS</code> requests are usually the easiest to decipher so I started with those</li>
                            <li>Following the <code>TCP</code> steam first, I found a couple intersting convos</li>
                        </ul>
                        <pre tabindex="0"><code>POST /GTSGIAG3 HTTP/1.1
Host: ocsp.pki.goog
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Length: 83
Content-Type: application/ocsp-request
Connection: keep-alive


0Q0O0M0K0I0 ..+...........cb2..5..u...J..l...w..P.gvv.-.....~.~.K..R.L.x.].c......bHTTP/1.1 200 OK
Content-Type: application/ocsp-response
Date: Mon, 15 Jul 2019 04:43:48 GMT
Cache-Control: public, max-age=86400
Server: ocsp_responder
Content-Length: 471
X-XSS-Protection: 0
X-Frame-Options: SAMEORIGIN

[ SNIP ]
</code></pre>
                        <p>and (#1)</p>
                        <pre tabindex="0"><code>GET / HTTP/1.1
Host: google.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: 1P_JAR=2019-07-12-21; NID=187=SDiyx-7X1cbM4j2nPqFKdqGpQ-RNK5s7iqKCqSykF9_Z1OanmoFDXXd72XOOn-9fw6vhOgmW19N5WTlvDV_xENDntejAO6leq32QEW8Ttu8ELp193MrH2E8WsSzJhKZ3aNT9PFTZzu4b8ThXLijiaNxkPSEXa63CA1FicOWsRZQ; OGP=-5061451:; ANID=AHWqTUlcGgtLQsX46euJwP8amo5yvh02jnSUY_-P-JNKVo0YcA6Jd7o075-uiQaN; OGPC=19012637-1:19012625-1:
Connection: keep-alive
Upgrade-Insecure-Requests: 1


HTTP/1.1 301 Moved Permanently
Location: http://www.google.com/
Content-Type: text/html; charset=UTF-8
Date: Mon, 15 Jul 2019 04:44:37 GMT
Expires: Wed, 14 Aug 2019 04:44:37 GMT
Cache-Control: public, max-age=2592000
Server: gws
Content-Length: 219
X-XSS-Protection: 0
X-Frame-Options: SAMEORIGIN


&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=&#34;content-type&#34; content=&#34;text/html;charset=utf-8&#34;&gt;
&lt;TITLE&gt;301 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;
&lt;H1&gt;301 Moved&lt;/H1&gt;
The document has moved
&lt;A HREF=&#34;http://www.google.com/&#34;&gt;here&lt;/A&gt;.
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
                        <p>and (#2)</p>
                        <pre tabindex="0"><code>GET /analysis.php?id=e7e47ecfd72c324519c9a72239cd2b399aaafc4b.9686&amp;fmt=card HTTP/1.1
Host: fotoforensics.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
Upgrade-Insecure-Requests: 1
Pragma: no-cache
Cache-Control: no-cache


HTTP/1.1 200 OK
Server: nginx
Date: Mon, 15 Jul 2019 04:44:56 GMT
Content-Type: image/png
Transfer-Encoding: chunked
Connection: keep-alive
X-Frame-Options: SAMEORIGIN
X-Xss-Protection: 1; mode=block
Pragma: cache
Access-Control-Allow-Origin: *
Cache-Control: no-transform,private,max-age=600,s-maxage=900
Expires: Mon, 15 Jul 2019 04:54:56 GMT
ETag: &#34;3KCUoJiun.nB8Iy_3biIsYO1yfyYqsn5za6W6pYx&#34;
FF-Length: 102908
Content-Disposition: inline; filename=&#34;e7e47ecfd72c324519c9a72239cd2b399aaafc4b.9686-card.png&#34;

[ plus an entire reacted png ]
</code></pre>
                        <p>and especially (stream 52 - <code>IRC</code> packet)</p>
                        <pre tabindex="0"><code>:irc.cct NOTICE Auth :*** Looking up your hostname...
CAP LS 302
PASS RedRoverRedRover$$
NICK zoobah
USER binaryphalanx 2 * :binaryphalanx
:irc.cct NOTICE Auth :*** Could not resolve your hostname: Request timed out; using your IP address (192.168.55.64) instead.
:irc.cct NOTICE Auth :Welcome to .Localnet.!
:irc.cct 001 zoobah :Welcome to the Localnet IRC Network zoobah!binaryphala@192.168.55.64
:irc.cct 002 zoobah :Your host is irc.cct, running version InspIRCd-2.0
:irc.cct 003 zoobah :This server was created on Debian
:irc.cct 004 zoobah irc.cct InspIRCd-2.0 iosw biklmnopstv bklov
:irc.cct 005 zoobah AWAYLEN=200 CASEMAPPING=rfc1459 CHANMODES=b,k,l,imnpst CHANNELLEN=64 CHANTYPES=# CHARSET=ascii ELIST=MU FNC KICKLEN=255 MAP MAXBANS=60 MAXCHANNELS=20 MAXPARA=32 :are supported by this server
:irc.cct 005 zoobah MAXTARGETS=20 MODES=20 NETWORK=Localnet NICKLEN=32 PREFIX=(ov)@+ STATUSMSG=@+ TOPICLEN=307 VBANLIST WALLCHOPS WALLVOICES :are supported by this server
:irc.cct 042 zoobah 108AAAAAC :your unique ID
:irc.cct 375 zoobah :irc.cct message of the day
:irc.cct 372 zoobah :- Welcome to the CCT Test Server for the PCAP assessment!
:irc.cct 376 zoobah :End of message of the day.
:irc.cct 251 zoobah :There are 1 users and 0 invisible on 1 servers
:irc.cct 254 zoobah 0 :channels formed
:irc.cct 255 zoobah :I have 1 clients and 0 servers
:irc.cct 265 zoobah :Current Local Users: 1 Max: 1
:irc.cct 266 zoobah :Current Global Users: 1 Max: 1
</code></pre>
                        <ul>
                            <li>I followed <code>DNS</code> aka <code>UDP</code> stream next which was mostly just the same google mozzila cloudflare github medium font api oscp (and cyber.meme.tips) things I had seen before</li>
                            <li>First I started with the GET request (found in and #2) for the site <code>fotoforensics.com/analysis.php?id=e7e47ecfd72c324519c9a72239cd2b399aaafc4b.9686</code></li>
                            <li>Which was basically steg analysis on this REALLY weird looking picture</li>
                            <li>None of the site steg checks found anything useful so I downloaded the image</li>
                        </ul>
                        <pre tabindex="0"><code>└─$ binwalk strange.png

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 300 x 300, 8-bit/color RGB, non-interlaced
166           0xA6            Zlib compressed data, default compression
</code></pre>
                        <ul>
                            <li>Ok this might just be nothing</li>
                            <li>Moving on to the IRC convo we have the username <code>binaryphalanx</code>, the password <code>RedRoverRedRover$$</code>, and the unique id <code>108AAAAAC</code></li>
                            <li>At this point I was kinda stuck. I have some info but nothing to do with it</li>
                            <li>I decided maybeee I should check the <code>ICMP</code> packets I had been ignoring for the past hour (there&rsquo;s no easy follow stream option, sue me idc)</li>
                            <li>I basically just speed scrolled through <code>ICMP</code> packets until I got a bright yellow message transfer param highlighted and continued doing this to decipher the conversation</li>
                        </ul>
                        <pre tabindex="0"><code># ROUGH recreation
- hi wyd
= hi nm
- u didn&#39;t send the thing
= not over this tf
- ok then over what
= lets use cryptcat instead
- another thing to install?
= no one can see this
- id still rather use encryption
= we need to pick a key to use
- ik just the one
- Angela Bennett uses it to log into the Bethesda Naval Hospital
= that old thing?
- lemme look it up rq
- found it, use the metasploit port to recieve
= listener is up, send it
- ok, it&#39;s sent
=
  7181f4d45de00ae35b6cf8201c8d852b
- hash is good
</code></pre>
                        <ul>
                            <li>Ok so we have a password <code>BER5348833</code> and a tool <code>cryptcat</code></li>
                            <li>The default listening port for most is <code>4444</code> so I checked traffic under that port <code>tcp.port == 4444</code></li>
                            <li>Used tshark for extraction:</li>
                        </ul>
                        <div class="highlight">
                            <pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>└─$ tshark -r pcap_chal.pcap -Y <span style="color:#e6db74">&#39;tcp.dstport == 4444&#39;</span> -Tfields -e data.data &gt; stream
</span></span><span style="display:flex;"><span>└─$ cat stream | xxd -r -p &gt;&gt; encfile
</span></span></code></pre>
                        </div>
                        <ul>
                            <li>Transferred and decrypted the file</li>
                        </ul>
                        <div class="highlight">
                            <pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>└─$ cryptcat -vv -k BER5348833 -lp <span style="color:#ae81ff">7777</span> &gt; dec
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>└─$ nc -vv -w <span style="color:#ae81ff">1</span> localhost <span style="color:#ae81ff">7777</span> &lt; encfile
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>└─$ file dec
</span></span><span style="display:flex;"><span>dec: ELF 64-bit LSB pie executable, x86-64, version <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>SYSV<span style="color:#f92672">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID<span style="color:#f92672">[</span>sha1<span style="color:#f92672">]=</span>10e9d33fce367a29cfe8d74866c3cb474ec61172, <span style="color:#66d9ef">for</span> GNU/Linux 3.2.0, stripped
</span></span></code></pre>
                        </div>
                        <ul>
                            <li>Modding perms and running the file itself threw an error</li>
                            <li>Running <code>strings</code> on the file I found this</li>
                        </ul>
                        <pre tabindex="0"><code>PRIVMSG H
#flag :CH
[]A\A]A^A_
irc.cct
ERROR %s
Failed to get ip
Found the server at %s
Connected to my server!
CAP LS 302
USER cct2019 cct2019 irc.cct :realname
NICK cct
JOIN #flag
</code></pre>
                        <ul>
                            <li>I also found the string <code>gethostbyname</code> which is definitely referring to <code>DNS</code></li>
                            <li>Based on the IRC convo from the pcap file earlier I assumed that the DNS resolution was through localhost</li>
                            <li>So I modified my <code>/etc/hosts</code> file with the <code>irc.cct</code> domain</li>
                        </ul>
                        <div class="highlight">
                            <pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>└─$ sudo sh -c <span style="color:#e6db74">&#34;echo &#39;127.0.0.1 irc.cct&#39; &gt;&gt; /etc/hosts&#34;</span>
</span></span></code></pre>
                        </div>
                        <ul>
                            <li>The file makes requests through the default IRC port <code>6667</code> so I set up a listener with <code>nc -lvnp 6667</code> and ran the file</li>
                        </ul>
                        <div class="highlight">
                            <pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>└─$ ./dec
</span></span><span style="display:flex;"><span>Found the server at 127.0.0.1
</span></span><span style="display:flex;"><span>Connected to my server!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>└─$ nc -lvnp <span style="color:#ae81ff">6667</span>
</span></span><span style="display:flex;"><span>listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">6667</span> ...
</span></span><span style="display:flex;"><span>connect to <span style="color:#f92672">[</span>127.0.0.1<span style="color:#f92672">]</span> from <span style="color:#f92672">(</span>UNKNOWN<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>127.0.0.1<span style="color:#f92672">]</span> <span style="color:#ae81ff">39222</span>
</span></span><span style="display:flex;"><span>CAP LS <span style="color:#ae81ff">302</span>
</span></span><span style="display:flex;"><span>USER cct2019 cct2019 irc.cct :realname
</span></span><span style="display:flex;"><span>NICK cct
</span></span><span style="display:flex;"><span>JOIN <span style="color:#75715e">#flag</span>
</span></span><span style="display:flex;"><span>PRIVMSG <span style="color:#75715e">#flag :CCT{h3&#39;s_a_pc@p_w1z@rd_th3re_hXXXXXXXXXXXXXXXXXXXX}</span>
</span></span></code></pre>
                        </div>
                        <ul>
                            <li>Done! (except for 3 more tasks &lt;/3)</li>
                        </ul>
                        <p><strong>Challenge 2</strong></p>
                        <ul>
                            <li>After downloading the file, I first checked for any obvious anomalies</li>
                        </ul>
                        <pre tabindex="0"><code>└─$ file re3_1583875067748.exe
re3_1583875067748.exe: PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows, 3 sections

└─$ binwalk re3_1583875067748.exe

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             Microsoft executable, portable (PE)
6503          0x1967          Copyright string: &#34;CopyrightAttribute&#34;
10587         0x295B          XML document, version: &#34;1.0&#34;
</code></pre>
                        <ul>
                            <li>Finding nothing out of the ordinary here, I started reverse engineering the executable</li>
                            <li>Running it on windows, it showed a window with four sliders that you could move to change the numbers displayed. After you move the sliders you could check your answer to see if you have gotten it right</li>
                            <li>Based on the behavior of the program, I assumed the sliders either had to match certain numbers or add up to a certain number to get the flag</li>
                            <li>Any wrong answers are met with <code>None shall pass! Again? Give up?</code></li>
                            <li>Running <code>strings</code> shows that the file is a <code>.NET</code> executable (Dotfuscator mentioned), so I downloaded <code>dotPeek</code> to decompile it</li>
                            <li>Right click exported the project to my IDE so I could look at all the C# code</li>
                            <li>Focusing mainly on the <code>a.cs</code> file I found this section</li>
                        </ul>
                        <div class="highlight">
                            <pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span>       <span style="color:#66d9ef">int</span> num1 = <span style="color:#ae81ff">711</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> num2 = <span style="color:#ae81ff">711000000</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (A_0_1 + A_1_1 + A_2 + A_4 == num1 &amp;&amp; A_0_1 * A_1_1 * A_2 * A_4 == num2 &amp;&amp; A_0_1 &gt; A_1_1 &amp;&amp; A_1_1 &gt; A_2 &amp;&amp; A_2 &gt; A_4)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">int</span> num3 = (<span style="color:#66d9ef">int</span>) MessageBox.Show(<span style="color:#66d9ef">this</span>.goodBoy(A_0_1, A_1_1, A_2, A_4, (<span style="color:#66d9ef">byte</span>[]) <span style="color:#66d9ef">this</span>.byteA.Clone()));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">int</span> num4 = (<span style="color:#66d9ef">int</span>) MessageBox.Show(<span style="color:#66d9ef">this</span>.badBoy(A_0_1, A_1_1, A_2, A_4, (<span style="color:#66d9ef">byte</span>[]) <span style="color:#66d9ef">this</span>.byteA.Clone()));
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre>
                        </div>
                        <ul>
                            <li>This basically says that the numbers on the sliders must add up to equal <code>711</code>, multiply to equal <code>711000000</code>, and each successive value is smaller than the last</li>
                            <li>So I wrote some python code to find the four values</li>
                        </ul>
                        <div class="highlight">
                            <pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">nums</span>():
</span></span><span style="display:flex;"><span>    num1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">711</span>
</span></span><span style="display:flex;"><span>    num2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">711000000</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> val1 <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">711</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> val2 <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, val1):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> val3 <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, val2):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> val4 <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, val3):
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> (val1 <span style="color:#f92672">+</span> val2 <span style="color:#f92672">+</span> val3 <span style="color:#f92672">+</span> val4 <span style="color:#f92672">==</span> num1 <span style="color:#f92672">and</span>
</span></span><span style="display:flex;"><span>                            val1 <span style="color:#f92672">*</span> val2 <span style="color:#f92672">*</span> val3 <span style="color:#f92672">*</span> val4 <span style="color:#f92672">==</span> num2):
</span></span><span style="display:flex;"><span>                        print(val1, val2, val3, val4)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>solution <span style="color:#f92672">=</span> nums()
</span></span><span style="display:flex;"><span>print(solution)
</span></span></code></pre>
                        </div>
                        <ul>
                            <li>Input the values for the sliders and got the flag! <code>31C02DCFDE2FCF727016XXXXXXXXXXXX</code></li>
                        </ul>
                        <p><strong>Challenge 3</strong></p>
                        <ul>
                            <li>The file for this challenge is a <code>jpeg</code></li>
                            <li>Started out with steg checks, string, binwalk, etc</li>
                        </ul>
                        <pre tabindex="0"><code>└─$ strings for1_8f90d68390b565c308871a52c6572de8_1583875226079.jpeg
JFIF
xExif
CCT 2019
http://ns.adobe.com/xap/1.0/

└─$ binwalk for1_8f90d68390b565c308871a52c6572de8_1583875226079.jpeg

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             JPEG image data, JFIF standard 1.01
30            0x1E            TIFF image data, big-endian, offset of first image directory: 8
29202         0x7212          Zip archive data, encrypted at least v2.0 to extract, compressed size: 159, uncompressed size: 189, name: fakeflag.txt
29529         0x7359          End of Zip archive, footer length: 22
</code></pre>
                        <ul>
                            <li>So its  <code>JFIF</code> adobe image with <code>exif</code> data, contains a <code>fakeflag.txt</code> file</li>
                            <li>Running exiftool I found this section</li>
                        </ul>
                        <pre tabindex="0"><code>Description                     : .--- ..- ... - .- .-- .- .-. -- ..- .--. .-. .. --. .... - ..--..
</code></pre>
                        <ul>
                            <li>Which decodes to <code>JUSTAWARMUPRIGHT?</code></li>
                            <li>I extracted the zip archive with <code>binwalk -e</code> which revealed an empty fakeflag file and a password protected zip archive which also contained a fakeflag file</li>
                            <li>To find the password <code>0ni0n_0f_0bfu5c@ti0n</code> I ran the image through <a href="http://georgeom.net/StegOnline/image">http://georgeom.net/StegOnline/image</a> with the LSB Half filter</li>
                            <li>This password didn&rsquo;t work, so I used the hint which was about lowercase passwords and used the first string from the morse code as the password</li>
                            <li>This password worked and I got the contents of the real <code>fakeflag.txt</code> file, which contained another password <code>Z10N0101</code></li>
                            <li>Assuming there was another zip file that binwalk didn&rsquo;t catch, I used steghide to keep searching</li>
                            <li>The third password worked for this one</li>
                        </ul>
                        <pre tabindex="0"><code>└─$ steghide extract -sf for1_8f90d68390b565c308871a52c6572de8_1583875226079.jpeg
Enter passphrase:
wrote extracted data to &#34;archive.zip&#34;.
</code></pre>
                        <ul>
                            <li>I extracted <code>archive.zip</code> with the second password which contained more txt files and a <code>flag.zip</code> archive</li>
                        </ul>
                        <pre tabindex="0"><code>└─$ cat cipher.txt
FSXL PXTH EKYT DJXS PYMO JLAY VPRP VO

└─$ cat config.txt
C G. VI. VII. VIII. AMTU RING AM BY CH DR EL FX GO IV JN KU PS QT WZ
</code></pre>
                        <ul>
                            <li>I replaced the cipher text with <code>JHSL PGLW YSQO DQVL PFAO TPCY KPUD TF</code> per the challenge description</li>
                            <li>the config file contains instructions for the enigma machine (M4 Shark, UKW C thin, first group of 4 are position, second four are ring)</li>
                            <li>Output minus spaces is the flag password <code>ctfforensicsisnotrealforensics</code></li>
                        </ul>
                        <pre tabindex="0"><code>└─$ cat flag.txt
CCT{Well_that_wasn&#39;t_suchXXXXXXXXXXXXXXXXXXXX}
</code></pre>
                        <ul>
                            <li>Done!</li>
                        </ul>
                        <p><strong>Challenge 4</strong></p>
                        <ul>
                            <li>I started by running <code>binwalk</code> on the file, which showed it contained two zip archives</li>
                        </ul>
                        <div class="highlight">
                            <pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>└─$ binwalk crypto1_1583878372378.zip
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>DECIMAL       HEXADECIMAL     DESCRIPTION
</span></span><span style="display:flex;"><span>--------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span>             0x0             Zip archive data, at least v2.0 to extract, compressed size: 226, uncompressed size: 363, name: crypto1a.txt
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">268</span>           0x10C           Zip archive data, at least v2.0 to extract, compressed size: 1487, uncompressed size: 1665, name: crypto1a.zip
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1985</span>          0x7C1           End of Zip archive, footer length: <span style="color:#ae81ff">22</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># unzipped the file</span>
</span></span><span style="display:flex;"><span>└─$ ls
</span></span><span style="display:flex;"><span>crypto1_1583878372378.zip  crypto1a.txt  crypto1a.zip
</span></span></code></pre>
                        </div>
                        <ul>
                            <li>The txt file contained cipher texts that looked like it was alphabet encoded, ROTed, substitution encoded, or something similar</li>
                        </ul>
                        <pre tabindex="0"><code>└─$ cat crypto1a.txt
Ab .aof y.jdbc&#39;g. urp ornkcbi Ja.oap ogxoycygycrb jcld.po ,cnn rbnf i.y frg or uap x.jago. ru lgbjygaycrb ofmxrnov  Oycnnw cy odrgne i.y frg jnro. .brgid yr ucigp. rgy yd. p.oyv  Xgy jab frg ucigp. rgy yd. t.f ,dcjd dall.bo yr x. yd. bam. ru yd. _nafrgy_ ,dcjd jp.ay.e ydcov Ajygannfw frg dae x.yy.p .by.p cy ydpcj. hgoy yr x. oau. (ann nr,.p[jao. cu frg ln.ao.)v
</code></pre>
                        <ul>
                            <li>I use dcode.fr for most of my decoding, so I tried the cipher identifier on that site</li>
                            <li>The highest result was a hill cipher (which didn&rsquo;t work)</li>
                            <li>I tried monoalphabetic:</li>
                        </ul>
                        <pre tabindex="0"><code>AN .ASY T.CHNI&#39;U. FOR SOLVING CA.SAR SUBSTITUTION CIPH.RS ,ILL ONLY G.T YOU SO FAR B.CAUS. OF PUNCTUATION SYMBOLSE STILLW IT SHOULD G.T YOU CLOS. .NOUGH TO FIGUR. OUT TH. R.STE BUT CAN YOU FIGUR. OUT TH. K.Y ,HICH HAPP.NS TO B. TH. NAM. OF TH. _LAYOUT_ ,HICH CR.AT.D THISE ACTUALLYW YOU HAD B.TT.R .NT.R IT THRIC. JUST TO B. SAF. (ALL LO,.R[CAS. IF YOU PL.AS.)E 


|🔤₁|AXJEVUIDCHTNMBRLZPOYGKWQFS|
|🔤₂|ANIHDYUJGCVPMLSRXOZKFEWBTQ|
</code></pre>
                        <ul>
                            <li>But this didn&rsquo;t give me the layout answer</li>
                            <li>So I tried keyboard swap:</li>
                        </ul>
                        <pre tabindex="0"><code>aN EASY TECHNIQUE FOR SOLVING cAESAR SUBSTITUTION CIPHERS WILL ONLY GET YOU SO FAR BECAUSE OF PUNCTUATION SYMBOLS&gt;  sTILL&lt; IT SHOULD GET YOU CLOSE ENOUGH TO FIGURE OUT THE REST&gt;  bUT CAN YOU FIGURE OUT THE KEY WHICH HAPPENS TO BE THE NAME OF THE &#39;LAYOUT&#39; WHICH CREATED THIS&gt; aCTUALLY&lt; YOU HAD BETTER ENTER IT THRICE JUST TO BE SAFE 9ALL LOWER_CASE IF YOU PLEASE0&gt;
</code></pre>
                        <ul>
                            <li>So the key is the name of the layout that created the ciphertext, all lowercase and repeated three times, which is the name of the keyboard layout used to decode the ciphertext</li>
                            <li>Using that to unzip the file, we get the first flag <code>CCT{Actu411y_a_w@rmup}</code></li>
                            <li>Now on to <code>crypto1b</code></li>
                        </ul>
                        <pre tabindex="0"><code>A word of advice for the next one. Don&#39;t straddle the fence or you&#39;ll end up riding a rail or five. It&#39;ll hurt from the bottom up.

n h newuhe eddre nect tota ufyaolim7ter val lcy vsf slAroeeoiroigtatradetlno o pek ?Sl n aee s epeth  atedpairu hsg?Hot oe.wygoelrfo 93aei alsw&#39;e  elntte l o.A eat o,b&#39; by le frnsk,nt tes uv hl o ir lgHayairiteobbaam ibuohlm tursernuuohgteseoob srk    spsrirt1 mdvoho&#39;eI nmpiihi ainuetere susutpa .lwc  dsa   t t,iiorgoguhfecae r tcslhslayhn eseaftaeo peelsantnthu e,nwati  Tetees ecfh ai ofCteb seisn eto potb hyli&#39;rCtirbsx oaego&#39;sbttamt u?Mingfh.e  ev dac cfp  c om  hahh t enm t.esg f ut t  oilso uhao
</code></pre>
                        <ul>
                            <li>Advice was a lil wild but this one isn&rsquo;t too bad</li>
                            <li>Started back with the dcode cipher identifier, which identified transposition cipher, skip cipher, and a few others</li>
                            <li>The hint mentions rails and fences, which was referring to the <code>rail fence cipher</code></li>
                            <li>I made sure to keep punctuation and spaces while decoding, and I ended up with this barely legible jumble of letters:</li>
                        </ul>
                        <pre tabindex="0"><code>onrving ggoht algfu throhhf a die.crent aeelleng  rHow a  tyou acesipherlvhike ts le? Soadyble bhanand a cemade s eier bacfuse otfahe plepoment   pthe ue er caslcsettera nnd putonuatiotmhhrougu  t thee ,ssagenhwo? Hoaatbout ih s for hTkey. e t way ete gooss  pellseecrrififnhrom t ma1973 i  matedotfvie oC.tharloeeb&#39;s we ssI&#39;ve egin a ms npelli fein tht oitle  upa cliottn youb  e. Athtye verl ieast &#39; rs fouCots, buiirt&#39;s pblsably xs . Allooawer ce g for ou&#39;dnessshbake, tat not aomt it t  ters,u ?i ouiM i
</code></pre>
                        <ul>
                            <li>Yeah there are obviously some missing letters</li>
                            <li><code>I've egin a ms npelli fein tht oitle  upa cliottn youb  e.</code> something about a youtube clip</li>
                            <li><code>hTkey. e t way ete gooss  pellseecrrififnhrom</code> and something about the key</li>
                            <li>the key is the way the goose spells ???</li>
                            <li>I looked up &ldquo;the way the goose spells&rdquo; and got a bunch of results with the word &ldquo;terrific&rdquo; in it</li>
                            <li>One youtube video title was <code>Goose Spells Teerrrriiffiiccc</code> and based on the missing letters and other things going on in the semi decoded ciphertext, I guessed that the key was <code>teerrrriiffiiccc</code> or some modification of it</li>
                            <li>Doing some more reasearch, I found this excerpt</li>
                        </ul>
                        <pre tabindex="0"><code>According to the goose, it’s, “T double-E double-R double-R double-I double-F double-I double C, C, C!” (E.B.White, _Charlotte’s Web_).
</code></pre>
                        <ul>
                            <li><code>teerrrriiffiicccccc</code>!</li>
                            <li>And we get the flag <code>CCT{th@t_w4s_XXXXXXXXXXXXXXXX}</code> honestly more OSINT than decoding</li>
                            <li>On to <code>crypto1c</code>:</li>
                        </ul>
                        <pre tabindex="0"><code>Last one of the basic batch. But is it compression, encoding, or encryption?

11122112141311112123131222211121621211124112213221112162112113114163113211421121132221622222411321311331611221121413111121231312222111216322121412123312222111122141624112123212416214122231631132114221112162321321242113531132142162321211424112123212322111121322231221111322216222232122141212112163113211422111216231224113221211211232216231224113113232121151124162312311111311416311321142211113212221112162411321222111216212111214132122211121623212114241121232123221111213222312211113222162411211422111124112214113316121421413132163131211211212321241642112141311112162222241132122211121624112231241121121121323221311416311321142141322122111216121212163131214121322213221111321311331615113114162411213242121632122411311322111211241631312211112123212416221321412132221112162411213222141621142211113212221112162112113222164211214131111132131622222123241122323113161421142111111341211212111151322122111122111111512213221111241122131151232121121135211422111132123221115124112123212311513113211422111111513113211211212111221111511
</code></pre>
                        <ul>
                            <li>Provided hint: start with <code>0</code>, not <code>1</code></li>
                            <li>Looks like a mix of binary and ascii</li>
                            <li>After staring at it <em>really</em> hard for about 10 minutes I was like &ldquo;what uses a ton of repetition and seems much longer than the final result should be?&rdquo;</li>
                            <li>Run Length Encoding! read about it <a href="http://en.wikipedia.org/wiki/Run-length_encoding">here</a></li>
                            <li>So back to dcode we go</li>
                            <li>I decoded it in binary mode (0 first as the hint says)</li>
                        </ul>
                        <pre tabindex="0"><code>01011001011011110111010100100111011101100110010100100000011011010110000101100100011001010010000001101001011101000010000001110100011010000110100101110011001000000110011001100001011100100010111000100000010110010110111101110101001001110111011001100101001000000111001101101111011011000111011001100101011001000010000001100001011011000110110000100000011011110110011000100000011101000110100001100101001000000110001101110010011110010111000001110100011011110010000001100011011010000110000101101100011011000110010101101110011001110110010101110011001000000110011001110010011011110110110100100000011101000110100001100101001000000110001001100001011100110110100101100011001000000110001001100001011101000110001101101000001011000010000001100010011101010111010000100
[ . . . ETC . . . ]
</code></pre>
                        <ul>
                            <li>Binary -&gt; ascii and we got the flag</li>
                        </ul>
                        <pre tabindex="0"><code>You&#39;ve made it this far. You&#39;ve solved all of the crypto challenges from the basic batch, but there are more challenges ahead. How will you fare against those I wonder. At any rate, well done and here is your flag: CCT{I_see_dead_XXXXXXXXXXXXXXXXXXXX}
</code></pre>
                        <ul>
                            <li>Done!</li>
                        </ul>
                    </section>
                </article>
            </main>
            <footer>
                <div class="footer-info">
                    xv1 2024-4L 
                    
                </div>
            </footer>
        </div>
    </body>
</html>
